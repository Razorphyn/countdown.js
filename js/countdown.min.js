/*!jQuery Professional Countdown*/
/**
 * Simple COuntdown with callback and Time Zone Support
 *
 * Where applicable: Copyright (c) 2013 Luca Grandi
 * Under MIT:
 * http://www.opensource.org/licenses/mit-license.php
 *
 */
(function(c){function n(){var c=document.createElement("canvas");return!(!c.getContext||!c.getContext("2d"))}c.fn.countdown=function(e){function q(){"knob"==a.skin.toLowerCase()&&n()?(a.skin=a.skin.toLowerCase(),b.append('<input class="'+a.option.day.eClass+'" type="text" value="0" data-readonly="true" /><input class="'+a.option.hour.eClass+'" type="text" value="0" data-readonly="true" /><input class="'+a.option.minute.eClass+'" type="text" value="0" data-readonly="true" /><input class="'+a.option.second.eClass+ '" type="text" value="0" data-readonly="true" />'),a.option.day.eClass="."+a.option.day.eClass.split(" ").join("."),a.option.hour.eClass="."+a.option.hour.eClass.split(" ").join("."),a.option.minute.eClass="."+a.option.minute.eClass.split(" ").join("."),a.option.second.eClass="."+a.option.second.eClass.split(" ").join("."),a.option.day.max=Math.floor((f-g)/86400),a.option.day.draw=function(){c(this.i).val(this.cv)},a.option.hour.draw=function(){c(this.i).val(this.cv)},a.option.minute.draw=function(){c(this.i).val(this.cv)}, a.option.second.draw=function(){c(this.i).val(this.cv)},b.find(a.option.day.eClass).knob(a.option.day),b.find(a.option.hour.eClass).knob(a.option.hour),b.find(a.option.minute.eClass).knob(a.option.minute),b.find(a.option.second.eClass).knob(a.option.second)):("knob"!=a.skin.toLowerCase()||n()?b.html('<ul class="'+a.skin+'"><li><span class="'+a.option.day.eClass+'">00</span><p class="timeRefDays">Days</p></li><li><span class="'+a.option.hour.eClass+'">00</span><p class="timeRefHours">Hours</p></li><li><span class="'+ a.option.minute.eClass+'">00</span><p class="timeRefMinutes">Minutes</p></li><li><span class="'+a.option.second.eClass+'">00</span><p class="timeRefSeconds">Seconds</p></li></ul>'):(a.skin=a.fallbackSkin,b.append('<ul class="'+a.skin+'" ><li><span class="'+a.option.day.eClass+'">00</span><p class="timeRefDays">Days</p></li><li><span class="'+a.option.hour.eClass+'">00</span><p class="timeRefHours">Hours</p></li><li><span class="'+a.option.minute.eClass+'">00</span><p class="timeRefMinutes">Minutes</p></li><li><span class="'+ a.option.second.eClass+'">00</span><p class="timeRefSeconds">Seconds</p></li></ul>')),a.option.day.eClass="."+a.option.day.eClass.split(" ").join("."),a.option.hour.eClass="."+a.option.hour.eClass.split(" ").join("."),a.option.minute.eClass="."+a.option.minute.eClass.split(" ").join("."),a.option.second.eClass="."+a.option.second.eClass.split(" ").join("."));h=b.find(a.option.day.eClass);k=b.find(a.option.hour.eClass);l=b.find(a.option.minute.eClass);m=b.find(a.option.second.eClass)}function r(){currentDate= ((new Date).getTime()-a.offset)/1E3;f<currentDate?(null!=a.callback&&a.callback.call(this),"undefined"!=typeof p&&clearInterval(p),seconds=minutes=hours=days=0):(seconds=Math.floor(f-currentDate),days=Math.floor(seconds/86400),seconds-=86400*days,hours=Math.floor(seconds/3600),seconds-=3600*hours,minutes=Math.floor(seconds/60),seconds-=60*minutes);"knob"!=a.skin?(days=(a.format=2<=String(days).length)?days:"0"+days,hours=(a.format=2<=String(hours).length)?hours:"0"+hours,minutes=(a.format=2<=String(minutes).length)? minutes:"0"+minutes,seconds=(a.format=2<=String(seconds).length)?seconds:"0"+seconds,h.text(days),k.text(hours),l.text(minutes),m.text(seconds),1==days?h.parent().children(".timeRefDays").text("Day"):h.parent().children(".timeRefDays").text("Days"),1==hours?k.parent().children(".timeRefHours").text("Hour"):k.parent().children(".timeRefHours").text("Hours"),1==minutes?l.parent().children(".timeRefMinutes").text("Minute"):l.parent().children(".timeRefMinutes").text("Minutes"),1==seconds?m.parent().children(".timeRefSeconds").text("Second"): m.parent().children(".timeRefSeconds").text("Seconds")):(h.val(days).trigger("change"),k.val(hours).trigger("change"),l.val(minutes).trigger("change"),m.val(seconds).trigger("change"))}var a={skin:"countdown_default",fallbackSkin:"countdown_default",option:{day:{max:null,eClass:"days"},hour:{max:23,eClass:"hours"},minute:{max:59,eClass:"minutes"},second:{max:59,eClass:"seconds"}},dateStart:null,dateEnd:null,format:!0,callback:null,timezone:!1,offset:0};e&&c.extend(!0,a,e);"string"==typeof a.dateEnd&& (datEnd=a.dateEnd.split(" "),datEnd[0]=datEnd[0].split("/"),datEnd[1]=datEnd[1].split(":"),datEnd=datEnd[0].concat(datEnd[1]));null!=a.dateStart&&"string"==typeof a.dateStart&&(datStart=a.dateStart.split(" "),datStart[0]=datStart[0].split("/"),datStart[1]=datStart[1].split(":"),datStart=datStart[0].concat(datStart[1]));var b=c(this),f=(new Date(datEnd[2],datEnd[0]-1,datEnd[1],datEnd[3],datEnd[4],datEnd[5])).getTime()/1E3,g=null!=a.dateStart?(new Date(datStart[2],datStart[0]-1,datStart[1],datStart[3], datStart[4],datStart[5])).getTime()/1E3:null,h,k,l,m;b.bind("configure",function(e,d){"undefined"!=typeof d.skin&&b.children("."+a.skin).hasClass(d.skin);d&&c.extend(!0,a,d);"string"==typeof a.dateEnd&&(datEnd=a.dateEnd.split(" "),datEnd[0]=datEnd[0].split("/"),datEnd[1]=datEnd[1].split(":"),datEnd=datEnd[0].concat(datEnd[1]));null!=a.dateStart&&"string"==typeof a.dateStart&&(datStart=a.dateStart.split(" "),datStart[0]=datStart[0].split("/"),datStart[1]=datStart[1].split(":"),datStart=datStart[0].concat(datStart[1])); f=(new Date(datEnd[2],datEnd[0]-1,datEnd[1],datEnd[3],datEnd[4],datEnd[5])).getTime()/1E3;g=null!=a.dateStart?(new Date(datStart[2],datStart[0]-1,datStart[1],datStart[3],datStart[4],datStart[5])).getTime()/1E3:null;!0==a.timezone&&null!=d.offset&&(a.offset=36E5*parseInt(a.offset)+6E4*(new Date).getTimezoneOffset());"undefined"!=typeof d.option&&"undefined"==typeof d.option.global&&(d.option.global={});a.option.day=c.extend(!0,{},a.option.global,a.option.day);a.option.hour=c.extend(!0,{},a.option.global, a.option.hour);a.option.minute=c.extend(!0,{},a.option.global,a.option.minute);a.option.second=c.extend(!0,{},a.option.global,a.option.second);"knob"==a.skin.toLowerCase()&&n()||(a.skin=a.fallbackSkin);a.option.day.eClass=a.option.day.eClass.substring(1).split(".").join(" ");a.option.hour.eClass=a.option.hour.eClass.substring(1).split(".").join(" ");a.option.minute.eClass=a.option.minute.eClass.substring(1).split(".").join(" ");a.option.second.eClass=a.option.second.eClass.substring(1).split(".").join(" "); b.children().remove();q()});b.bind("destroy",function(){clearInterval(b.attr("interval-id"));b.remove()});if(isNaN(f))alert("Invalid or null dateEnd mm/dd/yyyy. Example: 12/25/2013 17:30:00"),b.append("Invalid or null dateEnd mm/dd/yyyy. Example: 12/25/2013 17:30:00");else if("knob"!=a.skin||null!=g&&!isNaN(g))if(g>(new Date).getTime())alert("Starting date is greater than the current date"),b.append("Starting date is greater than the current date");else if(!0==a.timezone&&(a.offset=36E5*parseInt(a.offset)+ 6E4*(new Date).getTimezoneOffset()),"undefined"!=typeof e.option&&"undefined"==typeof e.option.global&&(e.option.global={}),a.option.day=c.extend(!0,{},a.option.global,a.option.day),a.option.hour=c.extend(!0,{},a.option.global,a.option.hour),a.option.minute=c.extend(!0,{},a.option.global,a.option.minute),a.option.second=c.extend(!0,{},a.option.global,a.option.second),q(),f>(new Date).getTime()/1E3){var p=setInterval(function(){r()},1E3);b.attr("interval-id",p)}else null!=a.callback&&a.callback.call(this); else alert("Invalid or null dateStart mm/dd/yyyy. Example: 12/25/2013 17:30:00"),b.append("Invalid or null dateStart mm/dd/yyyy. Example: 12/25/2013 17:30:00")}})(jQuery);